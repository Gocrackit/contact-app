{"ast":null,"code":"var _jsxFileName = \"G:\\\\myReact\\\\React-contact\\\\contact-app\\\\src\\\\ImageInput.js\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nconst readFileAsDataURL = file => new Promise(resolve => {\n  const reader = new FileReader();\n\n  reader.onload = event => {\n    resolve(event.target.result);\n  };\n\n  reader.readAsDataURL(file);\n});\n\nconst resizeImage = (imageURL, canvas, maxHeight) => new Promise(resolve => {\n  const image = new Image();\n\n  image.onload = () => {\n    const context = canvas.getContext('2d');\n\n    if (image.height > maxHeight) {\n      image.width *= maxHeight / image.height;\n      image.height = maxHeight;\n    }\n\n    context.clearRect(0, 0, canvas.width, canvas.height);\n    canvas.width = image.width;\n    canvas.height = image.height;\n    context.drawImage(image, 0, 0, image.width, image.height);\n    resolve(canvas.toDataURL('image/jpeg'));\n  };\n\n  image.src = imageURL;\n});\n/**\r\n * A custom <input> that dynamically reads and resizes image files before\r\n * submitting them to the server as data URLs. Also, shows a preview of the image.\r\n */\n\n\nclass ImageInput extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      value: ''\n    };\n\n    this.handleFileChange = event => {\n      const file = event.target.files[0];\n\n      if (file && file.type.match(/^image\\//)) {\n        readFileAsDataURL(file).then(originalURL => {\n          resizeImage(originalURL, this.canvas, this.props.maxHeight).then(url => {\n            this.setState({\n              value: url\n            });\n          });\n        });\n      } else {\n        this.setState({\n          value: ''\n        });\n      }\n    };\n\n    this.handleFormReset = () => {\n      this.setState({\n        value: ''\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.canvas = document.createElement('canvas');\n    this.fileInput.form.addEventListener('reset', this.handleFormReset);\n  }\n\n  componentWillUnmount() {\n    this.fileInput.form.removeEventListener('reset', this.handleFormReset);\n  }\n\n  render() {\n    const {\n      className,\n      name\n    } = this.props;\n    const {\n      value\n    } = this.state;\n    const style = {\n      position: 'relative'\n    };\n\n    if (value) {\n      style.backgroundImage = `url(\"${value}\")`;\n      style.backgroundRepeat = 'no-repeat';\n      style.backgroundPosition = 'center';\n      style.backgroundSize = 'cover';\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: className,\n      style: style,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"hidden\",\n      name: name,\n      value: value,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      ref: node => this.fileInput = node,\n      type: \"file\",\n      onChange: this.handleFileChange,\n      style: {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        opacity: 0\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nImageInput.propTypes = {\n  className: PropTypes.string,\n  name: PropTypes.string,\n  maxHeight: PropTypes.number\n};\nexport default ImageInput;","map":{"version":3,"sources":["G:/myReact/React-contact/contact-app/src/ImageInput.js"],"names":["React","PropTypes","readFileAsDataURL","file","Promise","resolve","reader","FileReader","onload","event","target","result","readAsDataURL","resizeImage","imageURL","canvas","maxHeight","image","Image","context","getContext","height","width","clearRect","drawImage","toDataURL","src","ImageInput","Component","state","value","handleFileChange","files","type","match","then","originalURL","props","url","setState","handleFormReset","componentDidMount","document","createElement","fileInput","form","addEventListener","componentWillUnmount","removeEventListener","render","className","name","style","position","backgroundImage","backgroundRepeat","backgroundPosition","backgroundSize","node","top","left","opacity","propTypes","string","number"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nconst readFileAsDataURL = (file) =>\r\n  new Promise(resolve => {\r\n    const reader = new FileReader()\r\n\r\n    reader.onload = (event) => {\r\n      resolve(event.target.result)\r\n    }\r\n\r\n    reader.readAsDataURL(file)\r\n  })\r\n\r\nconst resizeImage = (imageURL, canvas, maxHeight) =>\r\n  new Promise(resolve => {\r\n    const image = new Image()\r\n\r\n    image.onload = () => {\r\n      const context = canvas.getContext('2d')\r\n\r\n      if (image.height > maxHeight) {\r\n        image.width *= maxHeight / image.height\r\n        image.height = maxHeight\r\n      }\r\n\r\n      context.clearRect(0, 0, canvas.width, canvas.height)\r\n      canvas.width = image.width\r\n      canvas.height = image.height\r\n\r\n      context.drawImage(image, 0, 0, image.width, image.height)\r\n\r\n      resolve(canvas.toDataURL('image/jpeg'))\r\n    }\r\n\r\n    image.src = imageURL\r\n  })\r\n\r\n/**\r\n * A custom <input> that dynamically reads and resizes image files before\r\n * submitting them to the server as data URLs. Also, shows a preview of the image.\r\n */\r\nclass ImageInput extends React.Component {\r\n  static propTypes = {\r\n    className: PropTypes.string,\r\n    name: PropTypes.string,\r\n    maxHeight: PropTypes.number\r\n  }\r\n\r\n  state = {\r\n    value: ''\r\n  }\r\n\r\n  handleFileChange = (event) => {\r\n    const file = event.target.files[0]\r\n\r\n    if (file && file.type.match(/^image\\//)) {\r\n      readFileAsDataURL(file).then(originalURL => {\r\n        resizeImage(originalURL, this.canvas, this.props.maxHeight).then(url => {\r\n          this.setState({ value: url })\r\n        })\r\n      })\r\n    } else {\r\n      this.setState({ value: '' })\r\n    }\r\n  }\r\n\r\n  handleFormReset = () => {\r\n    this.setState({ value: '' })\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.canvas = document.createElement('canvas')\r\n    this.fileInput.form.addEventListener('reset', this.handleFormReset)\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.fileInput.form.removeEventListener('reset', this.handleFormReset)\r\n  }\r\n\r\n  render() {\r\n    const { className, name } = this.props\r\n    const { value } = this.state\r\n\r\n    const style = {\r\n      position: 'relative'\r\n    }\r\n\r\n    if (value) {\r\n      style.backgroundImage = `url(\"${value}\")`\r\n      style.backgroundRepeat = 'no-repeat'\r\n      style.backgroundPosition = 'center'\r\n      style.backgroundSize = 'cover'\r\n    }\r\n\r\n    return (\r\n      <div className={className} style={style}>\r\n        <input type=\"hidden\" name={name} value={value} />\r\n        <input\r\n          ref={node => this.fileInput = node}\r\n          type=\"file\"\r\n          onChange={this.handleFileChange}\r\n          style={{\r\n            position: 'absolute',\r\n            top: 0,\r\n            left: 0,\r\n            width: '100%',\r\n            height: '100%',\r\n            opacity: 0\r\n          }}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default ImageInput"]},"metadata":{},"sourceType":"module"}